<%- include('partials/head')%>



<!-- ##### Header Area Start ##### -->
<header class="header_area">
    <div class="classy-nav-container breakpoint-off d-flex align-items-center justify-content-between">
        <!-- Classy Menu -->
        <nav class="classy-navbar" id="essenceNav">
            <!-- Logo -->
            <a class="nav-brand" href="home"><img src="img/core-img/site-logo.png" alt=""></a>
            <!-- Navbar Toggler -->
            <div class="classy-navbar-toggler">
                <span class="navbarToggler"><span></span><span></span><span></span></span>
            </div>
            <!-- Menu -->
            <div class="classy-menu">
                <!-- close btn -->
                <div class="classycloseIcon">
                    <div class="cross-wrap"><span class="top"></span><span class="bottom"></span></div>
                </div>
                <!-- Nav Start -->
                <div class="classynav">
                    <ul>

                        <li><a href="#">Pages</a>
                            <ul class="dropdown">
                                <li><a href="home">Home</a></li>
                                <li><a href="shop">Shop</a></li>

                                <li><a href="checkout">Checkout</a></li>

                            </ul>
                        </li>

                    </ul>
                </div>
                <!-- Nav End -->
            </div>
        </nav>

        <!-- Header Meta Data -->
        <div class="header-meta d-flex clearfix justify-content-end">
            <!-- Search Area -->
            <div class="search-area">
                <form action="#" method="POST">
                    <input type="search" name="search" id="headerSearch" placeholder="Type for search">
                    <button type="submit"><i class="fa fa-search" aria-hidden="true"></i></button>
                </form>
            </div>
            <!-- Favourite Area -->
            <div class="favourite-area">
                <a href="#"><img src="img/core-img/heart.svg" alt=""></a>
            </div>
            <!-- User Login Info -->
            <div class="dropdown">
                <div class="user-login-info">
                    <a href="#"><img src="img/core-img/user.svg" alt=""></a>
                    <div class="dropdown-content">
                        <button class="desc" id="logout" onclick="logOut()">Log Out</button>
                    </div>
                </div>
            </div>
            <!-- Cart Area -->
            <div class="cart-area">
                <a href="#" id="essenceCartBtn"><img src="img/core-img/bag.svg" alt=""> <span
                        class="cart-item-quantity"></span></a>
            </div>
        </div>

    </div>
</header>
<!-- ##### Header Area End ##### -->

<!-- ##### Right Side Cart Area ##### -->
<div class="cart-bg-overlay"></div>

<div class="right-side-cart-area">

    <!-- Cart Button -->
    <div class="cart-button">
        <a href="#" id="rightSideCart"><img src="img/core-img/bag.svg" alt=""> <span
                class="cart-item-quantity"></span></a>
    </div>

    <div class="cart-content d-flex">

        <!-- Cart List Area -->
        <div class="cart-list" id="cartList">





            <!-- Single Cart Item -->

        </div>

        <!-- Cart Summary -->
        <div class="cart-amount-summary">

            <h2>Summary</h2>
            <ul class="summary-table">
                <li><span>subtotal:</span> <span  id="subtotal" class="subtotal"></span></li>
                <li><span>delivery:</span> <span>Free</span></li>
                <li><span>discount:</span> <span>N/A</span></li>
                <li><span>total:</span> <span  id="totalPrice" class="totalPrice"></span></li>
            </ul>
            <div class="checkout-btn mt-100">
                <a href="checkout" class="btn essence-btn">check out</a>
            </div>
        </div>
    </div>
</div>
<!-- ##### Right Side Cart End ##### -->

<!-- ##### Breadcumb Area Start ##### -->
<div class="breadcumb_area bg-img" style="background-image: url(img/bg-img/breadcumb.jpg);">
    <div class="container h-100">
        <div class="row h-100 align-items-center">
            <div class="col-12">
                <div class="page-title text-center">
                    <h2>Checkout</h2>
                </div>
            </div>
        </div>
    </div>
</div>
<!-- ##### Breadcumb Area End ##### -->

<!-- ##### Checkout Area Start ##### -->
<div class="checkout_area section-padding-80">
    <div class="container">
        <div class="row">

            <div class="col-12 col-md-6">
                <div class="checkout_details_area mt-50 clearfix">

                    <div class="cart-page-heading mb-30">
                        <h5>Billing Address</h5>
                    </div>

                    <form action="/postOrder" method="POST">
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label for="first_name">Name <span>*</span></label>
                                <input type="text" class="form-control" id="first_name" value="" name="fullname"
                                    required>
                            </div>
                            <!-- <div class="col-md-6 mb-3">
                                <label for="last_name">Last Name <span>*</span></label>
                                <input type="text" class="form-control" id="last_name" value="" required>
                            </div> -->
                            <!-- <div class="col-12 mb-3">
                                <label for="company">Company Name</label>
                                <input type="text" class="form-control" id="company" name="company" value="">
                            </div> -->
                            <!-- <div class="col-12 mb-3">
                                <label for="country">Country <span>*</span></label>
                                <select class="w-100" id="country">
                                    <option value="usa">United States</option>
                                    <option value="uk">United Kingdom</option>
                                    <option value="ger">Germany</option>
                                    <option value="fra">France</option>
                                    <option value="ind">India</option>
                                    <option value="aus">Australia</option>
                                    <option value="bra">Brazil</option>
                                    <option value="cana">Canada</option>
                                </select>
                            </div> -->
                            <div class="col-12 mb-3">
                                <label for="street_address">Address <span>*</span></label>
                                <input type="text" class="form-control mb-3" id="street_address" value=""
                                    name="address1" required>

                            </div>
                            <div class="col-12 mb-3">
                                <label for="postcode">Postcode <span>*</span></label>
                                <input type="text" class="form-control" id="postcode" value="" name="postcode" required>
                            </div>
                            <div class="col-12 mb-3">
                                <label for="city">Town/City <span>*</span></label>
                                <input type="text" class="form-control" id="city" value="" name="city" required>
                            </div>
                            <div class="col-12 mb-3">
                                <label for="state">Province <span>*</span></label>
                                <input type="text" class="form-control" id="state" value="" name="province" required>
                            </div>
                            <div class="col-12 mb-3">
                                <label for="phone_number">Phone No <span>*</span></label>
                                <input type="number" class="form-control" id="phone_number" min="0" value=""
                                    name="contact" required>
                            </div>
                            <div class="col-12 mb-4">
                                <label for="email_address">Email Address <span>*</span></label>
                                <input type="email" class="form-control" id="email_address" value="" name="email"
                                    required>
                            </div>

                            <div class="col-12">
                                <div class="custom-control custom-checkbox d-block mb-2">
                                    <input type="checkbox" class="custom-control-input" id="customCheck1">
                                    <label class="custom-control-label" for="customCheck1">Terms and conditions</label>
                                </div>

                                <div class="custom-control custom-checkbox d-block">
                                    <input type="checkbox" class="custom-control-input" id="customCheck3">
                                    <label class="custom-control-label" for="customCheck3">Subscribe to our
                                        newsletter</label>
                                </div>
                                <hr>
                            </div>
                        </div>

                </div>
            </div>

            <div class="col-12 col-md-6 col-lg-5 ml-lg-auto">
                <div class="order-details-confirmation">

                    <div class="cart-page-heading">
                        <h5>Your Order</h5>
                        <p>The Details</p>
                    </div>

                    <ul class="order-details-form mb-4">
                        <li><span>Product</span> <span>Amount</span></li>
                        <li><span>Cocktail Yellow dress</span> <span>$59.90</span></li>
                        <li><span>Subtotal</span> <span id="subtotal" class="subtotal"></span></li>
                        <li><span>Shipping</span> <span>Free</span></li>
                        <li><span><b>Total</b></span> <span><b class="totalPrice"></b></span></li>
                    </ul>

                    <div id="accordion" role="tablist" class="mb-4">
                        <div class="card">


                        </div>
                        <div class="card">
                            <div class="card-header" role="tab" id="headingTwo">
                                <h6 class="mb-0">
                                    <input class="collapsed" data-toggle="collapse" href="#collapseTwo"
                                        aria-expanded="false" aria-controls="collapseTwo" type="radio"> CASH ON
                                    DELIVERY</input>
                                    <p>* Delivery may take 4-6 working days</p>
                                </h6>
                            </div>

                        </div>

                        <div class="card">
                            <div class="card-header" role="tab" id="headingFour">

                            </div>

                        </div>
                    </div>

                    <button href="#" class="btn essence-btn" type="submit">Place Order</button>
                    </form>
                </div>
            </div>
        </div>
    </div>
</div>
<!-- ##### Checkout Area End ##### -->

<!-- ##### Footer Area Start ##### -->
<footer class="footer_area clearfix">
    <div class="container">
        <div class="row">
            <!-- Single Widget Area -->
            <div class="col-12 col-md-6">
                <div class="single_widget_area d-flex mb-30">
                    <!-- Logo -->
                    <div class="footer-logo mr-50">
                        <a href="#"><img src="img/core-img/site-logo-2.png" alt=""></a>
                    </div>
                    <!-- Footer Menu -->
                    <div class="footer_menu">
                        <ul>
                            <li><a href="shop">Shop</a></li>
                            <li><a href="#">Blog</a></li>
                            <li><a href="#">Contact</a></li>
                        </ul>
                    </div>
                </div>
            </div>
            <!-- Single Widget Area -->
            <div class="col-12 col-md-6">
                <div class="single_widget_area mb-30">
                    <ul class="footer_widget_menu">
                        <li><a href="#">Order Status</a></li>
                        <li><a href="#">Payment Options</a></li>
                        <li><a href="#">Shipping and Delivery</a></li>
                        <li><a href="#">Guides</a></li>
                        <li><a href="#">Privacy Policy</a></li>
                        <li><a href="#">Terms of Use</a></li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="row align-items-end">
            <!-- Single Widget Area -->
            <div class="col-12 col-md-6">
                <div class="single_widget_area">
                    <div class="footer_heading mb-30">
                        <h6>Subscribe</h6>
                    </div>
                    <div class="subscribtion_form">
                        <form action="#" method="post">
                            <input type="email" name="mail" class="mail" placeholder="Your email here">
                            <button type="submit" class="submit"><i class="fa fa-long-arrow-right"
                                    aria-hidden="true"></i></button>
                        </form>
                    </div>
                </div>
            </div>
            <!-- Single Widget Area -->
            <div class="col-12 col-md-6">
                <div class="single_widget_area">
                    <div class="footer_social_area">
                        <a href="#" data-toggle="tooltip" data-placement="top" title="Facebook"><i
                                class="fa fa-facebook" aria-hidden="true"></i></a>
                        <a href="#" data-toggle="tooltip" data-placement="top" title="Instagram"><i
                                class="fa fa-instagram" aria-hidden="true"></i></a>
                        <a href="#" data-toggle="tooltip" data-placement="top" title="Twitter"><i class="fa fa-twitter"
                                aria-hidden="true"></i></a>
                        <a href="#" data-toggle="tooltip" data-placement="top" title="Pinterest"><i
                                class="fa fa-pinterest" aria-hidden="true"></i></a>
                        <a href="#" data-toggle="tooltip" data-placement="top" title="Youtube"><i
                                class="fa fa-youtube-play" aria-hidden="true"></i></a>
                    </div>
                </div>
            </div>
        </div>

        <div class="row mt-5">
            <div class="col-md-12 text-center">
                <p>

                    Copyright &copy;<script>
                        document.write(new Date().getFullYear());
                    </script> All rights reserved

                </p>
            </div>
        </div>

    </div>


</footer>
<script>
       //logout


       function logOut() {

$.get("http://localhost:3000/logout", function (data, status) {})
window.location.reload();
}







let temp = "<%= itemsId %>"
let itemId = [];
if (temp == null || temp == "") {
itemId = [];
} else {
itemId = "<%= itemsId %>".split(",");
}

let items = [];
var amount = 0;

let count = itemId.length;

populateCart(itemId, count);

function populateCart(itemId, count) {
$("#cartList").html("");
for (let i = 0; i < itemId.length; i++) {
    $.get("http://localhost:3000/getProductById?id=" + itemId[i], function (data, status) {
        //   alert("Data: " + data[0].product_name + "\nStatus: " + status);
        // items.push(data[0]);

        // populateCart(data,count);


        // for (let i = 0; i < data.length; i++) {


        html = ` <div class="single-cart-item">
            <a href="#" class="product-image">
                <img src="${data[0]["image"]}" class="cart-thumb" alt="">
                <!-- Cart Item Desc -->
                <div class="cart-item-desc">
                    <span class="product-remove" id="close" onclick="removeItem(${i})"><i class="fa fa-close" aria-hidden="true"></i></span>
                    <span class="badge">${data[0]["brand"]}</span>
                    <h6>${data[0]["product_name"]}</h6>
                    <p class="size">${data[0]["memory"]}</p>
                    <p class="color">${data[0]["color"]}</p>
                    <p class="price">Rs.${data[0]["price"]}</p>
                </div>
            </a>
        </div>`;

        //for price calculation
        // itemId.forEach(id => {
        amount = amount + data[0]["price"]
        // console.log( amount + " --- " + data[i]["price"]);
        $("#subtotal").html('Rs. ' + amount)
        $("#totalPrice").html('Rs. ' + amount)

        // });
        // console.log( amount + " --- " + data[i]["price"]);

        //for adding item as html in cart
        $("#cartList").append(html);
        //for displaying items quantity in cart
        $(".cart-item-quantity").html(count);
        // }
    })

}
}


    function removeItem(id) {


        // $.get("http://localhost:3000/getProductById?id="+id, function(item, status){

        // let rmv = itemId.indexOf(id);
        // console.log(rmv);
        console.log(id);
        itemId.splice(id, 1);
        // console.log(itemId);
        // console.log(itemId.splice(rmv, 1));

        $('.product-remove').click(function (e) {

            e.preventDefault();

            //for removing selected item
            $(this).closest('.single-cart-item').remove();

            //for displaying no. of  remaining items in cart
            $(".cart-item-quantity").html(itemId.length);

            $.get("http://localhost:3000/removeItem?id=" + itemId, function (data, status) {
                console.log("item deleted");
            })

        })

        // }
        // )        

    }
</script>
<!-- ##### Footer Area End ##### -->





<!-- jQuery (Necessary for All JavaScript Plugins) -->
<script src="js/jquery/jquery-2.2.4.min.js"></script>
<!-- Popper js -->
<script src="js/popper.min.js"></script>
<!-- Bootstrap js -->
<script src="js/bootstrap.min.js"></script>
<!-- Plugins js -->
<script src="js/plugins.js"></script>
<!-- Classy Nav js -->
<script src="js/classy-nav.min.js"></script>
<!-- Active js -->
<script src="js/active.js"></script>

</body>

</html>